<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RelatÃ³rio - Sistema de Propostas TAG Investimentos</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Inter', sans-serif;
            background: #1A0A10;
            color: #E6E4DB;
            line-height: 1.8;
        }
        .container { max-width: 960px; margin: 0 auto; padding: 40px 24px; }

        /* Header */
        .header {
            text-align: center;
            padding: 60px 40px;
            background: linear-gradient(135deg, #3D0816 0%, #1A0A10 70%);
            border-radius: 16px;
            margin-bottom: 40px;
            border: 1px solid #630D2430;
        }
        .header h1 {
            font-size: 2.2rem;
            font-weight: 700;
            color: #E6E4DB;
            margin-bottom: 8px;
        }
        .header .subtitle {
            color: #FF8853;
            font-size: 1.1rem;
            font-weight: 500;
        }
        .header .date {
            color: #9A9590;
            margin-top: 16px;
            font-size: 0.9rem;
        }
        .header .tag-logo {
            color: #FF8853;
            font-size: 1.8rem;
            font-weight: 700;
            letter-spacing: 0.3em;
            margin-bottom: 24px;
        }
        .header .tag-sub {
            color: #9A9590;
            font-size: 0.7rem;
            letter-spacing: 0.4em;
            text-transform: uppercase;
        }

        /* Sections */
        .section {
            background: #2A1520;
            border-radius: 12px;
            padding: 32px;
            margin-bottom: 24px;
            border: 1px solid #630D2420;
        }
        .section h2 {
            color: #FF8853;
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 20px;
            padding-bottom: 8px;
            border-bottom: 2px solid #FF885330;
        }
        .section h3 {
            color: #E6E4DB;
            font-size: 1.05rem;
            font-weight: 600;
            margin: 20px 0 10px 0;
        }
        .section p { margin-bottom: 12px; }
        .section ul { margin: 8px 0 16px 24px; }
        .section li { margin-bottom: 6px; }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 16px 0;
        }
        th {
            text-align: left;
            padding: 12px 16px;
            background: #3D0816;
            color: #FF8853;
            font-weight: 600;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        td {
            padding: 10px 16px;
            border-bottom: 1px solid #630D2415;
            font-size: 0.9rem;
        }
        tr:hover td { background: #630D2408; }

        /* Code blocks */
        .code-block {
            background: #130810;
            border: 1px solid #630D2430;
            border-radius: 8px;
            padding: 16px 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            color: #6BDE97;
            overflow-x: auto;
            margin: 12px 0;
            white-space: pre;
            line-height: 1.5;
        }

        /* Metrics */
        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin: 20px 0;
        }
        .metric-card {
            background: linear-gradient(135deg, #321A28 0%, #2A1520 100%);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #630D2420;
            text-align: center;
        }
        .metric-card .label {
            color: #9A9590;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .metric-card .value {
            color: #FF8853;
            font-size: 1.8rem;
            font-weight: 700;
            margin-top: 4px;
        }
        .metric-card .detail {
            color: #9A9590;
            font-size: 0.8rem;
            margin-top: 4px;
        }

        /* Flow diagram */
        .flow {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            gap: 8px;
            margin: 20px 0;
        }
        .flow-step {
            background: #321A28;
            border: 1px solid #630D2430;
            border-radius: 8px;
            padding: 10px 16px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        .flow-arrow {
            color: #FF8853;
            font-size: 1.2rem;
        }

        /* Badges */
        .badge {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        .badge-ai { background: #5C85F720; color: #5C85F7; }
        .badge-db { background: #6BDE9720; color: #6BDE97; }
        .badge-ui { background: #FF885320; color: #FF8853; }
        .badge-engine { background: #FFBB0020; color: #FFBB00; }

        /* Feature grid */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
            margin: 20px 0;
        }
        .feature-card {
            background: #321A28;
            border-radius: 10px;
            padding: 20px;
            border-left: 3px solid #FF8853;
        }
        .feature-card h4 {
            color: #E6E4DB;
            font-size: 0.95rem;
            margin-bottom: 8px;
        }
        .feature-card p {
            color: #9A9590;
            font-size: 0.85rem;
            margin: 0;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 32px;
            color: #9A9590;
            font-size: 0.8rem;
            border-top: 1px solid #630D2415;
            margin-top: 40px;
        }

        /* Highlight */
        .highlight {
            color: #FF8853;
            font-weight: 600;
        }
        .highlight-green {
            color: #6BDE97;
            font-weight: 600;
        }

        /* TOC */
        .toc {
            background: #321A28;
            border-radius: 10px;
            padding: 24px;
            margin-bottom: 24px;
            border: 1px solid #630D2420;
        }
        .toc h3 { color: #FF8853; margin-bottom: 12px; }
        .toc a {
            color: #E6E4DB;
            text-decoration: none;
            display: block;
            padding: 4px 0;
            font-size: 0.9rem;
        }
        .toc a:hover { color: #FF8853; }
        .toc .num { color: #FF8853; font-weight: 600; margin-right: 8px; }

        @media print {
            body { background: white; color: #333; }
            .header { background: #f5f5f5; }
            .section { background: #fff; border: 1px solid #eee; }
        }
    </style>
</head>
<body>
    <div class="container">

        <!-- HEADER -->
        <div class="header">
            <div class="tag-logo">TAG</div>
            <div class="tag-sub">Investimentos</div>
            <h1 style="margin-top:24px">Sistema de Propostas para Prospects</h1>
            <div class="subtitle">RelatÃ³rio TÃ©cnico e Funcional</div>
            <div class="date">VersÃ£o 1.0 &middot; 24 de Fevereiro de 2026</div>
        </div>

        <!-- METRICS OVERVIEW -->
        <div class="metrics">
            <div class="metric-card">
                <div class="label">Linhas de CÃ³digo</div>
                <div class="value">4.246</div>
                <div class="detail">20 arquivos Python</div>
            </div>
            <div class="metric-card">
                <div class="label">Telas do Sistema</div>
                <div class="value">5</div>
                <div class="detail">Pipeline, Cadastro, Carteira, IA, Proposta</div>
            </div>
            <div class="metric-card">
                <div class="label">Base de Fundos</div>
                <div class="value">2.430</div>
                <div class="detail">Com dados de liquidaÃ§Ã£o</div>
            </div>
            <div class="metric-card">
                <div class="label">IntegraÃ§Ã£o IA</div>
                <div class="value">3</div>
                <div class="detail">DiagnÃ³stico, RecomendaÃ§Ã£o, Textos</div>
            </div>
        </div>

        <!-- TOC -->
        <div class="toc">
            <h3>SumÃ¡rio</h3>
            <a href="#visao"><span class="num">1.</span> VisÃ£o Geral</a>
            <a href="#tech"><span class="num">2.</span> Tecnologias Utilizadas</a>
            <a href="#arch"><span class="num">3.</span> Arquitetura de Arquivos</a>
            <a href="#telas"><span class="num">4.</span> Funcionalidades por Tela</a>
            <a href="#db"><span class="num">5.</span> Banco de Dados</a>
            <a href="#ia"><span class="num">6.</span> IntegraÃ§Ã£o com IA</a>
            <a href="#motor"><span class="num">7.</span> Motor de RealocaÃ§Ã£o</a>
            <a href="#uso"><span class="num">8.</span> Como Usar</a>
            <a href="#seguranca"><span class="num">9.</span> SeguranÃ§a</a>
            <a href="#proximos"><span class="num">10.</span> PrÃ³ximos Passos</a>
        </div>

        <!-- 1. VISÃƒO GERAL -->
        <div class="section" id="visao">
            <h2>1. VisÃ£o Geral</h2>
            <p>Foi desenvolvido um sistema completo de geraÃ§Ã£o de propostas para clientes prospects da TAG Investimentos. O sistema automatiza o fluxo que hoje Ã© manual em uma plataforma integrada com inteligÃªncia artificial.</p>

            <h3>Fluxo Anterior (Manual)</h3>
            <div class="flow">
                <div class="flow-step">Comercial coleta dados</div>
                <div class="flow-arrow">&rarr;</div>
                <div class="flow-step">Envia para GestÃ£o</div>
                <div class="flow-arrow">&rarr;</div>
                <div class="flow-step">GestÃ£o monta proposta</div>
                <div class="flow-arrow">&rarr;</div>
                <div class="flow-step">Envia ao cliente</div>
            </div>

            <h3>Fluxo Novo (Automatizado)</h3>
            <div class="flow">
                <div class="flow-step" style="border-color:#FF8853">Comercial cadastra no sistema</div>
                <div class="flow-arrow">&rarr;</div>
                <div class="flow-step" style="border-color:#5C85F7">IA analisa e gera proposta</div>
                <div class="flow-arrow">&rarr;</div>
                <div class="flow-step" style="border-color:#6BDE97">GestÃ£o revisa</div>
                <div class="flow-arrow">&rarr;</div>
                <div class="flow-step" style="border-color:#FFBB00">Cliente recebe link</div>
            </div>
        </div>

        <!-- 2. TECNOLOGIAS -->
        <div class="section" id="tech">
            <h2>2. Tecnologias Utilizadas</h2>
            <table>
                <thead>
                    <tr><th>Tecnologia</th><th>Uso</th></tr>
                </thead>
                <tbody>
                    <tr><td><span class="highlight">Python 3.10</span></td><td>Linguagem principal</td></tr>
                    <tr><td><span class="highlight">Streamlit</span></td><td>Interface web (frontend + backend)</td></tr>
                    <tr><td><span class="highlight">SQLite</span></td><td>Banco de dados local (propostas.db)</td></tr>
                    <tr><td><span class="highlight">Claude API (Anthropic)</span></td><td>InteligÃªncia artificial para diagnÃ³stico e recomendaÃ§Ã£o</td></tr>
                    <tr><td><span class="highlight">Plotly</span></td><td>GrÃ¡ficos interativos (donuts, barras, cenÃ¡rios)</td></tr>
                    <tr><td><span class="highlight">Pandas</span></td><td>ManipulaÃ§Ã£o e anÃ¡lise de dados</td></tr>
                    <tr><td><span class="highlight">python-dotenv</span></td><td>Gerenciamento seguro de API keys</td></tr>
                </tbody>
            </table>
        </div>

        <!-- 3. ARQUITETURA -->
        <div class="section" id="arch">
            <h2>3. Arquitetura de Arquivos</h2>
            <div class="code-block">Simulador de realocaÃ§Ã£o/
â”œâ”€â”€ proposta_app.py              &larr; ENTRY POINT
â”œâ”€â”€ app.py                       &larr; Simulador existente (inalterado)
â”œâ”€â”€ .env                         &larr; API Key
â”‚
â”œâ”€â”€ shared/                      (1.486 linhas)
â”‚   â”œâ”€â”€ brand.py                 Identidade visual TAG
â”‚   â”œâ”€â”€ date_utils.py            CÃ¡lculos de dias Ãºteis
â”‚   â”œâ”€â”€ fund_utils.py            Match de fundos + liquidaÃ§Ã£o
â”‚   â”œâ”€â”€ portfolio_utils.py       Parser de carteiras + cash flow
â”‚   â””â”€â”€ rebalancing.py           Motor de realocaÃ§Ã£o (5 fases)
â”‚
â”œâ”€â”€ database/                    (465 linhas)
â”‚   â”œâ”€â”€ db.py                    Schema SQLite
â”‚   â”œâ”€â”€ models.py                CRUD + estatÃ­sticas
â”‚   â””â”€â”€ propostas.db             Banco de dados
â”‚
â”œâ”€â”€ ai/                          (375 linhas)
â”‚   â”œâ”€â”€ client.py                Wrapper Claude API
â”‚   â”œâ”€â”€ diagnostico.py           DiagnÃ³stico com IA
â”‚   â””â”€â”€ recomendacao.py          RecomendaÃ§Ã£o personalizada
â”‚
â”œâ”€â”€ proposal_gen/                (438 linhas)
â”‚   â”œâ”€â”€ charts.py                GrÃ¡ficos Plotly
â”‚   â””â”€â”€ html_generator.py        HTML premium
â”‚
â”œâ”€â”€ pages_proposta/              (1.362 linhas)
â”‚   â”œâ”€â”€ p1_cadastro.py           Cadastro do Prospect
â”‚   â”œâ”€â”€ p2_carteira_atual.py     Carteira + DiagnÃ³stico
â”‚   â”œâ”€â”€ p3_proposta_ia.py        Proposta com IA
â”‚   â”œâ”€â”€ p4_visualizar.py         Preview + Export
â”‚   â””â”€â”€ p5_pipeline.py           Pipeline/CRM
â”‚
â”œâ”€â”€ modelos_carteira/            Carteiras modelo (Excel)
â”œâ”€â”€ propostas_html/              Propostas geradas
â””â”€â”€ Dados de liquid.xlsx         2.430 fundos</div>
        </div>

        <!-- 4. TELAS -->
        <div class="section" id="telas">
            <h2>4. Funcionalidades por Tela</h2>

            <div class="feature-grid">
                <div class="feature-card">
                    <h4>ðŸ“Š Pipeline / CRM</h4>
                    <p>Kanban visual com 5 colunas (Lead &rarr; Cliente). MÃ©tricas do funil, busca, filtros, registro de interaÃ§Ãµes e prÃ³ximas aÃ§Ãµes.</p>
                </div>
                <div class="feature-card">
                    <h4>ðŸ‘¤ Cadastro de Prospect</h4>
                    <p>FormulÃ¡rio completo: dados pessoais, perfil, patrimÃ´nio, objetivos, horizonte, retirada mensal, restriÃ§Ãµes (7 predefinidas + texto livre).</p>
                </div>
                <div class="feature-card">
                    <h4>ðŸ’¼ Carteira Atual</h4>
                    <p>Upload Excel ou manual. DiagnÃ³stico automÃ¡tico: HHI, top 3, liquidez (D+0 a D+30+), alocaÃ§Ã£o por estratÃ©gia. GrÃ¡ficos donut e barras.</p>
                </div>
                <div class="feature-card">
                    <h4>ðŸ¤– Proposta com IA</h4>
                    <p>Claude analisa perfil + restriÃ§Ãµes, gera diagnÃ³stico profissional, seleciona modelo, cria carteira personalizada. EditÃ¡vel pela gestÃ£o.</p>
                </div>
                <div class="feature-card">
                    <h4>ðŸ“„ Visualizar Proposta</h4>
                    <p>Preview completo com capa, mÃ©tricas, diagnÃ³stico, comparativo visual, recomendaÃ§Ã£o, tabela. Export HTML premium com dark theme TAG.</p>
                </div>
                <div class="feature-card">
                    <h4>ðŸ”„ Motor de RealocaÃ§Ã£o</h4>
                    <p>Algoritmo de 5 fases que garante caixa nunca negativo. 2.430 fundos com D+. Reutilizado do simulador existente.</p>
                </div>
            </div>

            <h3>Detalhamento: Campos do Cadastro</h3>
            <table>
                <thead><tr><th>SeÃ§Ã£o</th><th>Campos</th></tr></thead>
                <tbody>
                    <tr><td>Dados Pessoais</td><td>Nome, CPF/CNPJ, Email, Telefone, Tipo (PF/PJ), ResponsÃ¡vel</td></tr>
                    <tr><td>Perfil</td><td>Conservador/Moderado/Arrojado/Agressivo, PatrimÃ´nio Total, PatrimÃ´nio InvestÃ­vel, Horizonte, Retirada Mensal</td></tr>
                    <tr><td>Objetivos</td><td>PreservaÃ§Ã£o, Renda, Crescimento, Liquidez, ProteÃ§Ã£o Cambial, SucessÃ³rio, DiversificaÃ§Ã£o</td></tr>
                    <tr><td>RestriÃ§Ãµes</td><td>NÃ£o vender RF, Sem cripto, SÃ³ ESG, Sem RV, Sem exterior, Sem crÃ©dito privado, Manter previdÃªncia + Texto livre</td></tr>
                    <tr><td>Pipeline</td><td>Status (Lead &rarr; Cliente), ObservaÃ§Ãµes</td></tr>
                </tbody>
            </table>
        </div>

        <!-- 5. BANCO DE DADOS -->
        <div class="section" id="db">
            <h2>5. Banco de Dados</h2>
            <p>O sistema utiliza <span class="highlight">SQLite</span> com 3 tabelas principais:</p>

            <h3><span class="badge badge-db">prospects</span> Cadastro de Prospects</h3>
            <p>22 campos incluindo dados pessoais, perfil, patrimÃ´nio, objetivos (JSON), restriÃ§Ãµes (JSON), carteira (JSON), status do pipeline, timestamps.</p>

            <h3><span class="badge badge-db">propostas</span> Propostas Geradas</h3>
            <p>Cada proposta com: versÃ£o, modelo usado, textos da IA (diagnÃ³stico + recomendaÃ§Ã£o), carteira proposta (JSON), plano de transiÃ§Ã£o, cenÃ¡rios, status, link de compartilhamento.</p>

            <h3><span class="badge badge-db">interacoes</span> HistÃ³rico de InteraÃ§Ãµes</h3>
            <p>Registro de reuniÃµes, ligaÃ§Ãµes, emails, WhatsApp com descriÃ§Ã£o, responsÃ¡vel, prÃ³xima aÃ§Ã£o e data.</p>
        </div>

        <!-- 6. IA -->
        <div class="section" id="ia">
            <h2>6. IntegraÃ§Ã£o com IA (Claude API)</h2>

            <table>
                <thead><tr><th>MÃ³dulo</th><th>Input</th><th>Output</th></tr></thead>
                <tbody>
                    <tr>
                        <td><span class="badge badge-ai">DiagnÃ³stico</span></td>
                        <td>Perfil + carteira + mÃ©tricas (HHI, liquidez, concentraÃ§Ã£o)</td>
                        <td>Texto profissional: visÃ£o geral, pontos de atenÃ§Ã£o, oportunidades, recomendaÃ§Ã£o</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-ai">RecomendaÃ§Ã£o</span></td>
                        <td>Perfil + restriÃ§Ãµes + modelo base + carteira atual</td>
                        <td>JSON: carteira proposta personalizada + justificativa por mudanÃ§a</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-ai">Texto</span></td>
                        <td>DiagnÃ³stico + proposta + dados consolidados</td>
                        <td>Texto profissional para cada seÃ§Ã£o da proposta</td>
                    </tr>
                </tbody>
            </table>

            <p style="margin-top:16px"><strong>Modelo:</strong> Claude Sonnet (claude-sonnet-4-20250514)</p>
            <p><strong>Custo estimado:</strong> R$ 0,05 a R$ 0,15 por proposta</p>
            <p><strong>Fallback:</strong> Sem API Key, diagnÃ³sticos bÃ¡sicos (numÃ©ricos) funcionam normalmente</p>
        </div>

        <!-- 7. MOTOR -->
        <div class="section" id="motor">
            <h2>7. Motor de RealocaÃ§Ã£o (Reutilizado)</h2>
            <p>O sistema reutiliza o motor inteligente do Simulador de RealocaÃ§Ã£o existente (443 linhas):</p>
            <ul>
                <li><strong>Fase 0:</strong> CatÃ¡logo de fundos com gap analysis</li>
                <li><strong>Fase 1:</strong> Mapeamento de eventos de caixa</li>
                <li><strong>Fase 2:</strong> Cobertura de passivos (resgates de investidores)</li>
                <li><strong>Fase 3:</strong> Rebalanceamento de posiÃ§Ãµes acima do modelo</li>
                <li><strong>Fase 4:</strong> AplicaÃ§Ãµes em posiÃ§Ãµes abaixo do modelo (quando caixa permite)</li>
                <li><strong>Fase 5:</strong> ValidaÃ§Ã£o dia-a-dia (garante caixa nunca negativo)</li>
            </ul>
            <p style="margin-top:12px">Base de <span class="highlight">2.430 fundos brasileiros</span> com dados de conversÃ£o e liquidaÃ§Ã£o (D+).</p>
        </div>

        <!-- 8. COMO USAR -->
        <div class="section" id="uso">
            <h2>8. Como Usar</h2>

            <h3>Primeiro Uso</h3>
            <div class="code-block">cd "G:\Drives compartilhados\Gestao_AI\Simulador de realocaÃ§Ã£o"
pip install -r requirements.txt
streamlit run proposta_app.py</div>

            <h3>Fluxo Recomendado</h3>
            <div class="flow">
                <div class="flow-step">1. Pipeline</div>
                <div class="flow-arrow">&rarr;</div>
                <div class="flow-step">2. Cadastro</div>
                <div class="flow-arrow">&rarr;</div>
                <div class="flow-step">3. Carteira</div>
                <div class="flow-arrow">&rarr;</div>
                <div class="flow-step">4. IA Proposta</div>
                <div class="flow-arrow">&rarr;</div>
                <div class="flow-step">5. Visualizar</div>
            </div>

            <h3>Carteiras Modelo</h3>
            <p>Salvar arquivos Excel em <code>modelos_carteira/</code> com colunas: <span class="highlight">CÃ³digo</span>, <span class="highlight">Ativo</span>, <span class="highlight">% Alvo</span></p>
        </div>

        <!-- 9. SEGURANÃ‡A -->
        <div class="section" id="seguranca">
            <h2>9. SeguranÃ§a</h2>
            <ul>
                <li>API Key armazenada em <code>.env</code> (no <code>.gitignore</code>, nunca commitada)</li>
                <li>Banco SQLite local (nÃ£o exposto na internet)</li>
                <li>Propostas HTML sÃ£o arquivos estÃ¡ticos independentes</li>
                <li>Simulador original (app.py) permanece inalterado</li>
            </ul>
        </div>

        <!-- 10. PRÃ“XIMOS PASSOS -->
        <div class="section" id="proximos">
            <h2>10. PrÃ³ximos Passos Sugeridos</h2>
            <div class="feature-grid">
                <div class="feature-card" style="border-left-color:#6BDE97">
                    <h4>Carteiras Modelo Reais</h4>
                    <p>Salvar as carteiras modelo oficiais da TAG por perfil em modelos_carteira/</p>
                </div>
                <div class="feature-card" style="border-left-color:#5C85F7">
                    <h4>GeraÃ§Ã£o de PDF</h4>
                    <p>Adicionar export em PDF com reportlab para envio formal</p>
                </div>
                <div class="feature-card" style="border-left-color:#FFBB00">
                    <h4>CenÃ¡rios de ProjeÃ§Ã£o</h4>
                    <p>SimulaÃ§Ã£o Monte Carlo (otimista/base/pessimista) na proposta</p>
                </div>
                <div class="feature-card" style="border-left-color:#ED5A6E">
                    <h4>Plano de TransiÃ§Ã£o</h4>
                    <p>Cronograma Gantt integrado mostrando a migraÃ§Ã£o dia-a-dia</p>
                </div>
            </div>
        </div>

        <!-- FOOTER -->
        <div class="footer">
            <div style="color:#FF8853;font-size:1.2rem;font-weight:700;letter-spacing:0.2em;margin-bottom:8px">TAG</div>
            <p>TAG Investimentos &copy; 2026 &middot; Sistema de Propostas v1.0</p>
            <p style="margin-top:8px">Documento interno e confidencial</p>
        </div>

    </div>
</body>
</html>